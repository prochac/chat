<html>
<head>
    <title>Chat</title>
    <link rel="stylesheet" href="style.css">
</head>
<body id="app">
<ul id="messages"></ul>
<form id="form" action="/post-message" method="post">
    <input id="message" name="message" autocomplete="off" autofocus/>
    <button>Send</button>
</form>
<script>
    function reloadMessages() {
        return fetch("/get-messages")
            .then((response) => {
                return response.json()
            })
            .then((json) => {
                const newMessages = document.createElement("UL");
                newMessages.setAttribute("id", "messages");

                json.forEach((message) => {
                    const row = document.createElement("LI");
                    row.appendChild(document.createTextNode(message));
                    return newMessages.appendChild(row);
                });

                const messages = document.getElementById("messages");
                messages.parentNode.replaceChild(newMessages, messages);
            });
    }

    document.getElementById("app").onload = () => {
        reloadMessages();
        setInterval(reloadMessages, 5000);
    };
</script>
</body>
</html>
